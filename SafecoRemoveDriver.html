<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Safeco Web-to-Lead Form</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pikaday/css/pikaday.css">
  <script src="https://cdn.jsdelivr.net/npm/pikaday/pikaday.js"></script>
  <style>
    .hidden { display: none; }
    .error { border-color: #ef4444; }
    .error-message {
      color: #ef4444;
      font-size: 0.875rem;
      margin-top: 0.25rem;
    }
    .sf-date-field {
      color: #000 !important;
    }
    .sf-date-field::placeholder {
      color: #a0aec0 !important;
      opacity: 1;
    }
    .tooltip {
      position: relative;
      display: inline-block;
    }
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 320px;
      background-color: #f9fafb;
      color: #1f2937;
      text-align: left;
      border-radius: 6px;
      padding: 10px;
      border: 1px solid #d1d5db;
      position: absolute;
      z-index: 10;
      bottom: 125%;
      left: 50%;
      margin-left: -160px;
      font-size: 0.85rem;
      line-height: 1.3;
      box-shadow: 0 2px 6px rgb(0 0 0 / 0.15);
    }
    .tooltip:hover .tooltiptext,
    .tooltip:focus-within .tooltiptext {
      visibility: visible;
    }
  </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-6">
  <form
    action="https://test.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8&amp;orgId=00DU7000006EuID"
    method="POST"
    class="bg-white p-8 rounded-2xl shadow-md w-full max-w-xl space-y-6"
    id="mainForm"
    autocomplete="off"
  >
    <h2 class="text-2xl font-bold text-center text-gray-800">Safeco Form</h2>
    <!-- Hidden Fields -->
    <input type="hidden" name="oid" value="00DU7000006EuID" />
    <input type="hidden" name="recordType" value="012U7000003Ie25IAC" />
    <input type="hidden" name="retURL" value="https://bennettandporter.com/" />
    <input type="hidden" name="first_name" value="Removedriver" />
    <input type="hidden" name="last_name" value="Lead" />
    <input type="hidden" name="status" value="New" />
    <input type="hidden" name="phone" value="2367236712" />
    <input type="hidden" name="lead_source" value="Web Form" />
    <input type="hidden" name="company" value="Caelius Test Safeco New" />
<!-- <input type="hidden" name="debug" value=1>                              
<input type="hidden" name="debugEmail" value="annie.rawal@caeliusconsulting.com"> -->


    <!-- Policy Changes Section (email, request type, policy action) -->
    <section class="bg-gray-50 border rounded-xl p-6 shadow-inner" aria-label="Policy Changes Section">
      <h3 class="text-xl font-semibold mb-4 text-gray-700">Policy Changes</h3>
      <div class="mb-4">
        <label for="email" class="block text-sm font-medium text-gray-700">
          Email
        </label>
        <input
          type="email" id="email" name="email"
          class="mt-1 w-full p-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"
          autocomplete="off"
          required
        />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Select the Request Type:</label>
        <div class="flex space-x-4 mb-2">
          <label class="inline-flex items-center ">
            <input type="radio" name="00NU7000006IOzh" value="Quote" required class="mr-2 " />Quote
          </label>
          <label class="inline-flex items-center">
            <input type="radio" name="00NU7000006IOzh" value="Endorse" required class="mr-2" />Endorsement
          </label>
        </div>
        <div id="quotePolicyError" class="error-message hidden ">Please select an option</div>
      </div>
     <!-- <div>
        <label for="policyAction" class="block text-sm font-medium text-gray-700 mt-4 ">Policy Action</label>
        <select id="00NU7000005zuNN" name="00NU7000005zuNN" required class="mt-1 w-full p-2 border border-gray-300 rounded-lg shadow-sm mb-2">
          <option value="">--None--</option>
          <option value="Replace Vehicle">Replace Vehicle</option>
          <option value="Add Vehicle">Add Vehicle</option>
          <option value="Remove Vehicle">Remove Vehicle</option>
          <option value="Add Driver">Add Driver</option>
          <option value="Remove Driver">Remove Driver</option>
          <option value="Update Address">Update Address</option>
        </select>
        <div id="policyActionError" class="error-message hidden">Please select a policy action</div>
      </div> -->
      <!-- Moved fields: Policy Number, Line of Business, Effective Date -->
      <div class = "space-y-4 mt-2">
        <div>
          <label for="00NU7000005zuX3" class="block text-sm font-medium text-gray-700">Policy Number</label>
          <input
            type="text"
            id="00NU7000005zuX3"
            name="00NU7000005zuX3"
            required
            pattern="Y\d{7}"
            maxlength="8"
            minlength="8"
            class="mt-1 w-full p-2 border border-gray-300 rounded-lg shadow-sm"
            title="Policy Number must start with 'Y' and be 8 characters total (e.g., Y1234567)"
          />
          <div id="policyNumberError" class="error-message hidden">Policy Number must start with 'Y' and be 8 digits total (e.g., Y1234567).</div>
        </div>
        <div>
          <label for="00NU7000006Hi7d" class="block text-sm font-medium text-gray-700">Line of Business</label>
          <select id="00NU7000006Hi7d" name="00NU7000006Hi7d" required class="mt-1 w-full p-2 border border-gray-300 rounded-lg shadow-sm">
            <option value="">--None--</option>
            <option value="Auto (includes motorhome, trailer &amp; antique or classic)">Auto</option>
            <option value="Home">Home</option>
            <option value="Fire">Fire</option>
            <option value="Motorcycle">Motorcycle</option>
            <option value="Off-Road Rec Vehicle">Off-Road Rec Vehicle</option>
            <option value="Umbrella">Umbrella</option>
            <option value="Watercraft">Watercraft</option>
          </select>
        </div>
        <div>
          <label for="00NU7000005zuLl" class="block text-sm font-medium text-gray-700">Effective Date</label>
          <input 
            type="text" 
            id="00NU7000005zuLl" 
            name="00NU7000005zuLl"
            placeholder="MM/DD/YYYY"
            autocomplete="off"
            required
            class="mt-1 w-full p-2 border border-gray-700 rounded-lg shadow-sm sf-date-field" />
          <div id="00NU7000005zuLl_error" class="error-message hidden">Enter a valid MM/DD/YYYY date.</div>
        </div>
      </div>
    </section>
    <!-- Driver Details Section (Only First/Last/Middle name) -->
     
    <section class="bg-gray-50 border rounded-xl p-6 shadow-inner" aria-label="Driver Details Section">
      <h3 class="text-xl font-semibold mb-4 text-gray-700">Driver Details</h3>
            <div class="mb-4">
    <label for="00NU7000006j9bZ" class="block text-sm font-medium text-gray-700">
      Reason for Deleting Driver
    </label>
    <select id="00NU7000006j9bZ" name="00NU7000006j9bZ"
            class="mt-1 w-full p-2 border border-gray-300 rounded-lg shadow-sm">
      <option value="">--None--</option>
      <option value="No longer resides at this address">No longer resides at this address</option>
      <option value="Deceased">Deceased</option>
      <option value="Incarcerated">Incarcerated</option>
      
    </select>
  </div>
      <div id="driverDetailsSection" class = "space-y-4 mb-3">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

          <div>
            <label for="00NU7000005zuOz" class="block text-sm font-medium text-gray-700">First Name</label>
            <input type="text" id="00NU7000005zuOz" name="00NU7000005zuOz" required class="w-full p-2 border border-gray-300 rounded-lg" />
          </div>
          
<div>
  <label for="birthYear" class="block text-sm font-medium text-gray-700">
    Birth Year
  </label>
  <select
    id="00NU7000006lumT"
    name="birthYear"
    required
    class="w-full p-2 border border-gray-300 rounded-lg"
  >
    <option value="">--Select Year--</option>
    <!-- Years are generated by JS below -->
  </select>
  <div id="birthYearError" class="error-message hidden">
    Please select a birth year.
  </div>
</div>
         
        </div>
      </div>

      <div>
            <label for="00NU7000005zuVR" class="block text-sm font-medium text-gray-700">Relationship to Insured</label>
            <select id="00NU7000005zuVR" name="00NU7000005zuVR" required class="w-full p-2 border border-gray-300 rounded-lg mb-4 ">
              <option value="">--Select--</option>
              <option value="Spouse">Spouse</option>
              <option value="Domestic Partner">Domestic Partner</option>
              <option value="Child">Child</option>
              <option value="Parent">Parent</option>
              <option value="Other Relative">Other Relative</option>
              <option value="Roommate">Roommate</option>
            </select>
          </div>

          <div id="maritalStatusContainer" class="hidden w-full mb-4">
  <label for="00NU7000006kjDB" class="block text-sm font-medium text-gray-700">
    What will be the marital status of insured driver?
  </label>
  <select id="00NU7000006kjDB" name="00NU7000006kjDB" class="mt-1 w-full p-2 border border-gray-300 rounded-lg shadow-sm">
    <option value="">--None--</option>
    <option value="Divorced">Divorced</option>
    <option value="Separated">Separated</option>
    <option value="Widowed">Widowed</option>
  </select>
</div>
    </section>


    <section class="bg-gray-50 border rounded-xl p-6 shadow-inner" aria-label="Vehicle Information Section">
      <h3 class="text-xl font-semibold mb-4 text-gray-700">Vehicle Information</h3>
      <div class="space-y-4">
        <!-- VIN -->
        

        <!-- Vehicle Use -->
        <div>
      <label for="00NU7000006N0iD" class="block text-sm font-medium text-gray-700">Vehicle Use</label>
      <select id="00NU7000006N0iD" name="00NU7000006N0iD" required 
              class="mt-1 w-full p-2 border border-gray-300 rounded-lg shadow-sm">
        <option value="">--None--</option>
        <option value="Pleasure or Work/School < 4 miles">Pleasure or Work/School < 4 miles</option>
        <option value="Work/School 4 or more miles">Work/School 4 or more miles</option>
      </select>
    </div>

      <!-- Conditional Fields -->
        <div id="vehicleCommuteFields" class="hidden space-y-4">
          <!-- Mileage One Way -->
          <div>
            <label for="00NU7000006kjI1" class="block text-sm font-medium text-gray-700">Mileage One Way</label>
            <input type="text" id="00NU7000006kjI1" name="00NU7000006kjI1" class="w-full p-2 border border-gray-300 rounded-lg" />
          </div>

       
       
        </div>
         <!-- Annual Mileage -->
        <div>
      <label for="00NU7000006N0zx" class="block text-sm font-medium text-gray-700">Annual Miles</label>
      <input type="text" id="00NU7000006N0zx" name="00NU7000006N0zx" required 
             class="w-full p-2 border border-gray-300 rounded-lg"  />
    </div>

    <div>
      <label for="00NU7000006N0wj" class="block text-sm font-medium text-gray-700">Ownership</label>
      <select id="00NU7000006N0wj" name="00NU7000006N0wj" required 
              class="mt-1 w-full p-2 border border-gray-300 rounded-lg shadow-sm">
        <option value="">--None--</option>
        <option value="Owned">Owned</option>
        <option value="Financed">Financed</option>
        <option value="Leased">Leased</option>
      </select>
    </div>

       

          
      </div>
    </section>


    <div class="pt-4">
      <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg shadow">
        Submit
      </button>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // MM/DD/YYYY Pikaday Setup & Validation for Effective Date only
        function parseMMDDYYYY(s) {
          if (!/^(\d{2})\/(\d{2})\/(\d{4})$/.test(s)) return null;
          const [m, d, y] = s.split('/').map(Number);
          if (m < 1 || m > 12 || d < 1 || d > 31) return null;
          const date = new Date(y, m - 1, d);
          if (date.getMonth() !== m - 1 || date.getDate() !== d || date.getFullYear() !== y) return null;
          return date;
        }
        document.querySelectorAll('.sf-date-field').forEach(function(field) {
          new Pikaday({
            field: field,
            format: 'MM/DD/YYYY',
            onSelect: function(date) {
              if (date) {
                field.value = ("0" + (date.getMonth()+1)).slice(-2) + "/" +
                              ("0" + date.getDate()).slice(-2) + "/" + date.getFullYear();
                showDateError(field, false);
              }
            }
          });
          field.addEventListener('input', function() {
            const valid = !field.value || parseMMDDYYYY(field.value);
            showDateError(field, !valid);
            field.setCustomValidity(valid ? "" : "Invalid date format (MM/DD/YYYY)");
          });
          field.addEventListener('blur', function() {
            const valid = !field.value || parseMMDDYYYY(field.value);
            showDateError(field, !valid);
            field.setCustomValidity(valid ? "" : "Invalid date format (MM/DD/YYYY)");
          });
        });
        function showDateError(field, show) {
          const errorDiv = document.getElementById(field.id + "_error");
          if(errorDiv) errorDiv.classList.toggle("hidden", !show);
          field.classList.toggle("error", show);
        }
        // Policy Number Live Validation
        const policyNumberInput = document.getElementById("00NU7000005zuX3");
        const policyNumberError = document.getElementById("policyNumberError");
        function validatePolicyNumberField() {
          const val = policyNumberInput.value.trim();
          const valid = /^Y\d{7}$/.test(val);
          policyNumberInput.classList.toggle("error", !valid && val.length > 0);
          policyNumberError.classList.toggle("hidden", valid || val.length === 0);
          policyNumberInput.setCustomValidity(valid || val.length === 0 ? "" : "Policy Number must start with 'Y' and be 8 characters (e.g., Y1234567)");
        }
        policyNumberInput.addEventListener("input", validatePolicyNumberField);
        policyNumberInput.addEventListener("blur", validatePolicyNumberField);
        const form = document.getElementById("mainForm");
        form?.addEventListener("submit", function (e) {
          validatePolicyNumberField();
          // Validate Effective Date
          const effDate = document.getElementById("00NU7000005zuLl");
          if (effDate && !parseMMDDYYYY(effDate.value)) {
            showDateError(effDate, true);
            effDate.setCustomValidity("Invalid date format (MM/DD/YYYY)");
            effDate.focus();
            e.preventDefault();
            return;
          }
          // native validation
          const invalid = form.querySelector(":invalid");
          if (invalid) {
            e.preventDefault();
            invalid.scrollIntoView({ behavior: "smooth", block: "center" });
            invalid.focus();
          }
        });
        validatePolicyNumberField();

         // 🚗 Vehicle Use Conditional Logic
    const vehicleUse = document.getElementById("00NU7000006N0iD");
    const commuteFields = document.getElementById("vehicleCommuteFields");
    const mileageOneWay = document.getElementById("00NU7000006kjI1");
    

    function toggleCommuteFields() {
      if (vehicleUse.value === "Work/School 4 or more miles") {
        commuteFields.classList.remove("hidden");
        mileageOneWay.required = true;
        
      } else {
        commuteFields.classList.add("hidden");
        mileageOneWay.required = false;
        mileageOneWay.value = "";
        
      }
    }

    vehicleUse.addEventListener("change", toggleCommuteFields);
    toggleCommuteFields();

    const relationshipToInsured = document.getElementById("00NU7000005zuVR");
const maritalStatusContainer = document.getElementById("maritalStatusContainer");
const maritalStatusField = document.getElementById("00NU7000006kjDB");

function toggleMaritalStatusField() {
  if (relationshipToInsured && maritalStatusContainer && maritalStatusField) {
    if (relationshipToInsured.value === "Spouse") {
      maritalStatusContainer.classList.remove("hidden");
      maritalStatusField.required = true;
    } else {
      maritalStatusContainer.classList.add("hidden");
      maritalStatusField.required = false;
      maritalStatusField.value = "";
    }
  }
}

if(relationshipToInsured){
  relationshipToInsured.addEventListener("change", toggleMaritalStatusField);
  toggleMaritalStatusField(); // initial call on page load
}

const birthYearSelect = document.getElementById("00NU7000006lumT");
if (birthYearSelect) {
  const currentYear = new Date().getFullYear();
  for (let y = currentYear; y >= 1900; y--) {
    const opt = document.createElement("option");
    opt.value = String(y);
    opt.text = String(y);
    birthYearSelect.appendChild(opt);
  }

  birthYearSelect.addEventListener("change", function() {
    const valid = birthYearSelect.value !== "";
    birthYearSelect.classList.toggle("error", !valid);
    document.getElementById("birthYearError").classList.toggle("hidden", valid);
    birthYearSelect.setCustomValidity(valid ? "" : "Please select a birth year");
  });
} else {
  console.error("Could not find birth year dropdown!");
}


      });
    </script>
  </form>
</body>
</html>
